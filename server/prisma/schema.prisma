generator client {
  provider = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL_PORTAIL")
}

model UtilisateurPortail {
  id                    Int                     @id @default(autoincrement())
  idInterne             Int?                    @unique
  roleId                Int?
  email                 String                  @unique
  telephone             String?                 @db.VarChar(20)
  modifieLe             DateTime                @updatedAt
  deletedAt             DateTime?
  Prenom                String
  createdAt             DateTime                @default(now())
  nom                   String
  password              String
  username              String                  @unique
  detenteurId           Int?
  entreprise_verified   Boolean                 @default(false)
  auditLogs             AuditLogPortail[]
  conversationsInitiees Conversation[]          @relation("ConversationUser1")
  conversationsRecues   Conversation[]          @relation("ConversationUser2")
  demandes              demandePortail[]
  messagesRecus         MessagePortail[]        @relation("ReceivedMessages")
  messagesEnvoyes       MessagePortail[]        @relation("SentMessages")
  paiements             Paiement[]
  sessions              SessionPortail[]
  userGroups            UserGroup[]
  detenteur             DetenteurMoralePortail? @relation(fields: [detenteurId], references: [id_detenteur])
  role                  Role?                   @relation(fields: [roleId], references: [id])
  emailVerified          Boolean   @default(false)  ///////////
  verificationCode       String?   // stocke le code hashé ou en clair (hashé = mieux)  ////////////
  verificationCodeExpires DateTime? // date d’expiration   ///////////////

  @@map("utilisateurs_portail")
}

model SessionPortail {
  id        Int                @id @default(autoincrement())
  token     String             @unique @db.VarChar(64)
  userId    Int
  expiresAt DateTime
  createdAt DateTime           @default(now())
  user      UtilisateurPortail @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([token])
  @@index([userId])
  @@index([expiresAt])
  @@map("sessions_portail")
}

model AuditLogPortail {
  id             Int                 @id @default(autoincrement())
  action         String              @db.VarChar(100)
  entityType     String              @db.VarChar(100)
  entityId       Int?
  userId         Int?
  timestamp      DateTime            @default(now())
  changes        Json?
  previousState  Json?
  ipAddress      String?             @db.VarChar(45)
  userAgent      String?
  status         String              @default("SUCCESS") @db.VarChar(20)
  errorMessage   String?
  contextId      String?
  sessionId      String?
  additionalData Json?
  user           UtilisateurPortail? @relation(fields: [userId], references: [id])

  @@index([entityType])
  @@index([entityId])
  @@index([userId])
  @@index([timestamp])
  @@index([contextId])
  @@map("audit_logs_portail")
}

model Role {
  id              Int                  @id @default(autoincrement())
  name            String               @unique @db.VarChar(100)
  rolePermissions RolePermission[]
  users           UtilisateurPortail[]

  @@map("roles")
}

model Permission {
  id               Int               @id @default(autoincrement())
  name             String            @unique @db.VarChar(100)
  groupPermissions GroupPermission[]
  rolePermissions  RolePermission[]

  @@map("permissions")
}

model RolePermission {
  roleId       Int
  permissionId Int
  permission   Permission @relation(fields: [permissionId], references: [id], onDelete: Cascade)
  role         Role       @relation(fields: [roleId], references: [id], onDelete: Cascade)

  @@id([roleId, permissionId])
  @@map("role_permissions")
}

model Group {
  id               Int               @id @default(autoincrement())
  name             String            @unique @db.VarChar(100)
  description      String?
  groupPermissions GroupPermission[]
  userGroups       UserGroup[]

  @@map("groups")
}

model UserGroup {
  userId    Int
  groupId   Int
  createdAt DateTime           @default(now())
  group     Group              @relation(fields: [groupId], references: [id], onDelete: Cascade)
  user      UtilisateurPortail @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@id([userId, groupId])
  @@map("user_groups")
}

model GroupPermission {
  groupId      Int
  permissionId Int
  group        Group      @relation(fields: [groupId], references: [id], onDelete: Cascade)
  permission   Permission @relation(fields: [permissionId], references: [id], onDelete: Cascade)

  @@id([groupId, permissionId])
  @@map("group_permissions")
}

model Conversation {
  id        Int                @id @default(autoincrement())
  user1Id   Int
  user2Id   Int
  createdAt DateTime           @default(now())
  updatedAt DateTime           @updatedAt
  user1     UtilisateurPortail @relation("ConversationUser1", fields: [user1Id], references: [id], onDelete: Cascade)
  user2     UtilisateurPortail @relation("ConversationUser2", fields: [user2Id], references: [id], onDelete: Cascade)
  messages  MessagePortail[]

  @@unique([user1Id, user2Id])
  @@index([user1Id])
  @@index([user2Id])
  @@map("conversations")
}

model MessagePortail {
  id             Int                @id @default(autoincrement())
  content        String
  senderId       Int
  receiverId     Int
  conversationId Int?
  isRead         Boolean            @default(false)
  createdAt      DateTime           @default(now())
  updatedAt      DateTime           @updatedAt
  conversation   Conversation?      @relation(fields: [conversationId], references: [id])
  receiver       UtilisateurPortail @relation("ReceivedMessages", fields: [receiverId], references: [id], onDelete: Cascade)
  sender         UtilisateurPortail @relation("SentMessages", fields: [senderId], references: [id], onDelete: Cascade)

  @@index([senderId])
  @@index([receiverId])
  @@index([conversationId])
  @@index([createdAt])
  @@map("messages_portail")
}

model NotificationPortail {
  id                Int           @id @default(autoincrement())
  type              String
  title             String        @db.VarChar(255)
  message           String
  isRead            Boolean       @default(false)
  createdAt         DateTime      @default(now())
  relatedEntityId   Int?
  relatedEntityType String?
  expertId          Int?
  priority          String        @default("info")
  expert            ExpertMinier? @relation(fields: [expertId], references: [id_expert])

  @@map("notifications_portail")
}

model Antenne {
  id_antenne   Int             @id @default(autoincrement())
  nom          String
  localisation String?
  Email        String?
  Telephone    String?
  Responsable  String?
  wilayas      Wilaya[]
  permis       PermisPortail[]
}

model Wilaya {
  id_wilaya    Int                      @id @default(autoincrement())
  id_antenne   Int
  code_wilaya  String                   @unique
  nom_wilayaFR String
  nom_wilayaAR String
  zone         String
  daira        Daira[]
  antenne      Antenne                  @relation(fields: [id_antenne], references: [id_antenne])
  Demande      demandePortail[]
  Interaction  InteractionWaliPortail[]
}

model Daira {
  id_daira    Int              @id @default(autoincrement())
  id_wilaya   Int
  nom_dairaFR String
  nom_dairaAR String
  communes    Commune[]
  wilaya      Wilaya           @relation(fields: [id_wilaya], references: [id_wilaya])
  Demande     demandePortail[]
}

model Commune {
  id_commune    Int              @id @default(autoincrement())
  id_daira      Int?
  nom_communeFR String
  nom_communeAR String
  nature        String?
  daira         Daira?           @relation(fields: [id_daira], references: [id_daira])
  Demande       demandePortail[]
  // (la relation inverse vers la table pivot)
  demandesCommunes DemandeCommune[]
}
// Table pivot many-to-many
model DemandeCommune {
  id_demande Int
  id_commune Int
  principale Boolean? @default(false)  // optionnel : commune principale

  demande  demandePortail @relation(fields: [id_demande], references: [id_demande])
  commune  Commune       @relation(fields: [id_commune], references: [id_commune])

  @@id([id_demande, id_commune])
}

model Pays {
  id_pays     Int                       @id @default(autoincrement())
  code_pays   String                    @unique @db.VarChar(10)
  nom_pays    String                    @db.VarChar(100)
  entreprises DetenteurMoralePortail[]
  personnes   PersonnePhysiquePortail[]

  @@map("pays")
}

model Nationalite {
  id_nationalite     Int                       @id @default(autoincrement())
  libelle            String                    @unique
  detenteurs         DetenteurMoralePortail[]
  personnesPhysiques PersonnePhysiquePortail[]

  @@map("nationalite")
}

model StatutJuridiquePortail {
  id_statutJuridique      Int                       @id @default(autoincrement())
  code_statut             String                    @unique
  statut_fr               String
  statut_ar               String
  FormeJuridiqueDetenteur FormeJuridiqueDetenteur[]

  @@map("statutjuridique")
}

model FormeJuridiqueDetenteur {
  id_formeDetenteur Int                    @id @default(autoincrement())
  id_statut         Int
  id_detenteur      Int
  date              DateTime?
  detenteur         DetenteurMoralePortail @relation(fields: [id_detenteur], references: [id_detenteur])
  statutJuridique   StatutJuridiquePortail @relation(fields: [id_statut], references: [id_statutJuridique])

  @@map("formejuridiquedetenteur")
}

model ExpertMinier {
  id_expert      Int                   @id @default(autoincrement())
  nom_expert     String
  num_agrement   String?
  date_agrement  DateTime?
  etat_agrement  String?
  adresse        String?
  email          String?
  tel_expert     String?
  fax_expert     String?
  specialisation String?
  demandes       demandePortail[]
  Notification   NotificationPortail[]

  @@map("expertminier")
}

model PersonnePhysiquePortail {
  id_personne          Int                      @id @default(autoincrement())
  id_pays              Int?
  id_nationalite       Int?
  nomFR                String
  nomAR                String?
  prenomFR             String
  prenomAR             String?
  date_naissance       DateTime?
  lieu_naissance       String?
  adresse_domicile     String?
  telephone            String?
  fax                  String?
  email                String?
  qualification        String?
  siteWeb              String?
  num_carte_identite   String?                  @unique
  lieu_juridique_soc   String?
  ref_professionnelles String?
  pouvoirs             PouvoirPersonnePhysique?
  cessionsAncien       demCession[]             @relation("AncienCessionnaire")
  cessionsNouveau      demCession[]             @relation("NouveauCessionnaire")
  fonctions            FonctionPersonneMoral[]
  nationaliteRef       Nationalite?             @relation(fields: [id_nationalite], references: [id_nationalite])
  pays                 Pays?                    @relation(fields: [id_pays], references: [id_pays])

  @@map("personnephysique")
}

model DetenteurMoralePortail {
  id_detenteur            Int                       @id @default(autoincrement())
  idInterne               Int?                      @unique
  date_constitution       DateTime
  id_pays                 Int?
  id_nationalite          Int?
  PP                      Boolean?
  National                Boolean?
  Privé                  Boolean?
  remarques               String?
  nom_societeFR           String?
  nom_societeAR           String?
  adresse_siege           String?
  telephone               String?
  fax                     String?
  email                   String?
  site_web                String?
  statutDetenteur         StatutDetenteur?
  detenteurdemande        DetenteurDemandePortail[]
  nationaliteRef          Nationalite?              @relation(fields: [id_nationalite], references: [id_nationalite])
  pays                    Pays?                     @relation(fields: [id_pays], references: [id_pays])
  fonctions               FonctionPersonneMoral[]
  FormeJuridiqueDetenteur FormeJuridiqueDetenteur[]
  Permis                  PermisPortail[]
  registreCommerce        RegistreCommercePortail[]
  transfertDetenteur      TransfertDetenteur[]
  utilisateurs            UtilisateurPortail[]

  @@map("detenteurmorale")
}

model DetenteurDemandePortail {
  id_detenteurDemande Int                    @id @default(autoincrement())
  id_demande          Int
  id_detenteur        Int
  role_detenteur      String?
  demande             demandePortail         @relation(fields: [id_demande], references: [id_demande], onDelete: Cascade)
  detenteur           DetenteurMoralePortail @relation(fields: [id_detenteur], references: [id_detenteur], onDelete: Cascade)

  @@index([id_demande])
  @@index([id_detenteur])
  @@map("detenteur_demande_portail")
}

model FonctionPersonneMoral {
  id_fonctionDetent  Int                      @id
  id_detenteur       Int?
  id_personne        Int?
  type_fonction      EnumTypeFonction?
  statut_personne    String?
  taux_participation Float?
  detenteur          DetenteurMoralePortail?  @relation(fields: [id_detenteur], references: [id_detenteur])
  personne           PersonnePhysiquePortail? @relation(fields: [id_personne], references: [id_personne])

  @@map("fonctionpersonnemoral")
}

model RegistreCommercePortail {
  id                  Int                     @id @default(autoincrement())
  id_detenteur        Int?
  numero_rc           String?
  date_enregistrement DateTime?
  capital_social      Float?
  nis                 String?
  nif                 String?
  adresse_legale      String?
  detenteur           DetenteurMoralePortail? @relation(fields: [id_detenteur], references: [id_detenteur])

  @@map("registrecommerce")
}

model TypePermis {
  id                     Int                     @id @default(autoincrement())
  id_taxe                Int?
  lib_type               String?                 @unique
  code_type              String?                 @unique
  regime                 String?
  duree_initiale         Float?
  nbr_renouv_max         Int?
  duree_renouv           Float?
  delai_renouv           Int?
  superficie_max         Float?
  ref_legales            String?
  DossierAdministratif   DossierAdministratif[]
  Barems                 BaremProduitetDroit[]
  combinaisionPermisProc combinaisonPermisProc[]
  Demande                demandePortail[]
  permis                 PermisPortail[]
  PermisTemplate         PermisTemplate[]
  taxe                   SuperficiaireBareme?    @relation(fields: [id_taxe], references: [id])

  @@map("typepermis")
}

model SuperficiaireBareme {
  id               Int          @id @default(autoincrement())
  droit_fixe       Float
  periode_initiale Float
  premier_renouv   Float
  autre_renouv     Float
  devise           String
  typePermis       TypePermis[]

  @@map("superficiaire_bareme")
}

model BaremProduitetDroit {
  id                  Int           @id @default(autoincrement())
  montant_droit_etab  Float
  produit_attribution Float
  typePermisId        Int
  typeProcedureId     Int
  typePermis          TypePermis    @relation(fields: [typePermisId], references: [id])
  typeProcedure       TypeProcedure @relation(fields: [typeProcedureId], references: [id])

  @@map("barem_produit_droit")
}

model PermisTemplate {
  id           Int            @id @default(autoincrement())
  name         String
  elements     Json
  typePermisId Int
  permisId     Int?
  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  version      Int            @default(1)
  permis       PermisPortail? @relation(fields: [permisId], references: [id])
  typePermis   TypePermis     @relation(fields: [typePermisId], references: [id])

  @@index([typePermisId])
  @@index([permisId])
  @@map("permis_templates")
}

model demandePortail {
  id_demande               Int                           @id @default(autoincrement())
  id_proc                  Int?
  id_wilaya                Int?
  id_daira                 Int?
  id_commune               Int?
  id_typeProc              Int?
  id_typePermis            Int?
  id_expert                Int?
  code_demande             String?
  date_demande             DateTime?
  date_instruction         DateTime?
  date_fin_instruction     DateTime?
  date_refus               DateTime?
  lieu_ditFR               String?
  lieu_dit_ar              String?
  superficie               Float?
  statut_juridique_terrain String?
  occupant_terrain_legal   String?
  destination              String?
  LocPointOrigine          String?
  description_travaux      String?
  sources_financement      String?
  remarques                String?
  num_enregist             String?
  Nom_Prenom_Resp_Enregist String?
  statut_demande           String
  dossier_recevable        Boolean?
  dossier_complet          Boolean?
  duree_instruction        Int?
  PP                       Boolean?
  id_sourceProc            Int?
  utilisateurId            Int
  communes                 DemandeCommune[]
  perimetre                Json?  // ← pour stocker le vrai polygon GeoJSON
  facture                  Facture?
  CahierCharge             CahierChargePortail[]
  cession                  demCession?
  demFermeture             demFermeture?
  fusion                   demFusion?
  Substitution             demSubstitution?
  transfert                demTransfert?
  demAnnulation            demAnnulation?
  demInitial               demInitial?
  modification             demModification?
  renonciation             demRenonciation?
  commune                  Commune?                      @relation(fields: [id_commune], references: [id_commune])
  daira                    Daira?                        @relation(fields: [id_daira], references: [id_daira])
  expertMinier             ExpertMinier?                 @relation(fields: [id_expert], references: [id_expert])
  procedure                ProcedurePortail?             @relation(fields: [id_proc], references: [id_proc])
  sourceProcedure          ProcedurePortail?             @relation("DemandeSource", fields: [id_sourceProc], references: [id_proc])
  typePermis               TypePermis?                   @relation(fields: [id_typePermis], references: [id])
  typeProcedure            TypeProcedure?                @relation(fields: [id_typeProc], references: [id])
  wilaya                   Wilaya?                       @relation(fields: [id_wilaya], references: [id_wilaya])
  utilisateur              UtilisateurPortail            @relation(fields: [utilisateurId], references: [id])
  demandeMins              demandeMin?
  verificationGeo          demandeVerificationGeo?
  detenteurdemande         DetenteurDemandePortail[]
  dossiersFournis          DossierFournisPortail[]
  droitPreemption          DroitPreemption?
  inscriptionProvisoire    InscriptionProvisoirePortail?
  renouvellement           ProcedureRenouvellement?

  @@map("demande")
}

model demInitial {
  id_demInitial         Int            @id @default(autoincrement())
  id_demande            Int            @unique
  duree_trvx            Int?
  qualite_signataire    String?
  date_demarrage_prevue DateTime?
  dossier_recevable     Boolean?
  dossier_complet       Boolean?
  rec_enquete_date      DateTime?
  rec_enquete_nomRespon String?
  obs_attestation       String?
  ConResGeo             Float?
  ConResExp             Float?
  VolumePrevu           Float?
  obs_sit_geo           String?
  obs_empiet            String?
  obs_emplacement       String?
  obs_geom              String?
  obs_superficie        String?
  inscripProv           Boolean?
  intitule_projet       String?
  montant_produit       Float?
  demande               demandePortail @relation(fields: [id_demande], references: [id_demande], onDelete: Cascade)

  @@map("dem_initial_portail")
}

model ProcedureRenouvellement {
  id_renouvellement     Int            @id @default(autoincrement())
  id_demande            Int            @unique
  duree_trvx            Int?
  qualite_signataire    String?
  date_demarrage_prevue DateTime?
  dossier_recevable     Boolean?
  dossier_complet       Boolean?
  rec_enquete_date      DateTime?
  rec_enquete_nomRespon String?
  obs_attestation       String?
  ConResGeo             Float?
  ConResExp             Float?
  VolumePrevu           Float?
  obs_sit_geo           String?
  obs_empiet            String?
  obs_emplacement       String?
  obs_geom              String?
  obs_superficie        String?
  inscripProv           Boolean?
  num_decision          String?
  date_decision         DateTime?
  date_debut_validite   DateTime?
  date_fin_validite     DateTime?
  commentaire           String?
  demande               demandePortail @relation(fields: [id_demande], references: [id_demande], onDelete: Cascade)

  @@map("procedure_renouvellement_portail")
}

model demFermeture {
  id_fermeture Int            @id @default(autoincrement())
  id_demande   Int            @unique
  num_decision String?
  date_constat DateTime?
  rapport      String?
  demande      demandePortail @relation(fields: [id_demande], references: [id_demande])
}

model demAnnulation {
  id_annulation         Int            @id @default(autoincrement())
  id_demande            Int            @unique
  origin_cadastre       Boolean?
  verif_doc             String?
  permis_annule         Boolean?
  date_vigueur          DateTime?
  DatePrepDocAnnulation DateTime?
  num_decision          String?
  date_constat          DateTime?
  date_annulation       DateTime?
  cause_annulation      String?
  statut_annulation     String?
  demande               demandePortail @relation(fields: [id_demande], references: [id_demande], onDelete: Cascade)

  @@map("dem_annulation_portail")
}

model demSubstitution {
  id_substitution    Int            @id @default(autoincrement())
  id_demande         Int            @unique
  num_decision       String?
  date_decision      DateTime?
  motif_substitution String?
  commentaires       String?
  demande            demandePortail @relation(fields: [id_demande], references: [id_demande])
}

model demModification {
  id_modification       Int            @id @default(autoincrement())
  id_demande            Int            @unique
  duree_trvx            Int?
  qualite_signataire    String?
  date_demarrage_prevue DateTime?
  dossier_recevable     Boolean?
  dossier_complet       Boolean?
  rec_enquete_date      DateTime?
  rec_enquete_nomRespon String?
  obs_attestation       String?
  ConResGeo             Float?
  ConResExp             Float?
  VolumePrevu           Float?
  obs_sit_geo           String?
  obs_empiet            String?
  obs_emplacement       String?
  obs_geom              String?
  obs_superficie        String?
  inscripProv           Boolean?
  intitule_projet       String?
  montant_produit       Float?
  type_modif            String?
  type_modification     String?
  statut_modification   String?
  idDivisionEnCurso     Int?
  demande               demandePortail @relation(fields: [id_demande], references: [id_demande], onDelete: Cascade)

  @@map("dem_modification_portail")
}

model demCession {
  id_cession             Int                     @id @default(autoincrement())
  id_demande             Int                     @unique
  id_ancienCessionnaire  Int
  id_nouveauCessionnaire Int
  motif_cession          String?
  nature_cession         String?
  taux_cession           Float?
  date_validation        DateTime?
  ancienCessionnaire     PersonnePhysiquePortail @relation("AncienCessionnaire", fields: [id_ancienCessionnaire], references: [id_personne])
  demande                demandePortail          @relation(fields: [id_demande], references: [id_demande])
  NouveauCessionnaire    PersonnePhysiquePortail @relation("NouveauCessionnaire", fields: [id_nouveauCessionnaire], references: [id_personne])
}

model demRenonciation {
  id_renonciation    Int            @id @default(autoincrement())
  id_demande         Int            @unique
  motif_renonciation String?
  rapport_technique  String?
  RenonOct           Boolean?
  demande            demandePortail @relation(fields: [id_demande], references: [id_demande], onDelete: Cascade)

  @@map("dem_renonciation_portail")
}

model demFusion {
  id_fusion          Int                  @id @default(autoincrement())
  id_demande         Int                  @unique
  id_permisResultant Int                  @unique
  date_fusion        DateTime
  motif_fusion       String?
  statut_fusion      String?
  demande            demandePortail       @relation(fields: [id_demande], references: [id_demande])
  permis             PermisPortail        @relation(fields: [id_permisResultant], references: [id])
  fusionPermisSource fusionPermisSource[]
}

model demTransfert {
  id_transfert       Int                  @id @default(autoincrement())
  id_demande         Int                  @unique
  motif_transfert    String?
  observations       String?
  dossier_octroyable Boolean?
  transfer_obtenu    Boolean?
  date_transfert     DateTime             @default(now())
  demande            demandePortail       @relation(fields: [id_demande], references: [id_demande])
  transfertDetenteur TransfertDetenteur[]
}

model TransfertDetenteur {
  id                  Int                     @id @default(autoincrement())
  id_transfert        Int
  id_detenteur        Int?
  type_detenteur      EnumTypeDetenteur
  role                String?
  date_enregistrement DateTime?
  detenteur           DetenteurMoralePortail? @relation(fields: [id_detenteur], references: [id_detenteur])
  transfert           demTransfert            @relation(fields: [id_transfert], references: [id_transfert])

  @@map("transfert_detenteur")
}

model demandeVerificationGeo {
  id_demVerif                Int            @id @default(autoincrement())
  id_demande                 Int            @unique
  sit_geo_ok                 Boolean?
  empiet_ok                  Boolean?
  superf_ok                  Boolean?
  geom_ok                    Boolean?
  verification_cadastrale_ok Boolean?
  superficie_cadastrale      Float?
  demande                    demandePortail @relation(fields: [id_demande], references: [id_demande])
}

/// model demandeObs {
/// id_demandeObs     Int            @id @default(autoincrement())
/// id_demande        Int            @unique
/// obs_situation_geo String?
/// obs_empietement   String?
/// obs_emplacement   String?
/// obs_geom          String?
/// obs_superficie    String?
/// demande           DemandePortail @relation(fields: [id_demande], references: [id_demande], onDelete: Cascade)
///
/// @@map("demande_obs_portail")
/// }
model demandeMin {
  id_demMin     Int            @id @default(autoincrement())
  id_demande    Int            @unique
  min_label     String?
  min_teneur    Float?
  ordre_mineral String?
  demande       demandePortail @relation(fields: [id_demande], references: [id_demande])
}
  model PermisPortail {
    id                       Int       @id @default(autoincrement())
    id_typePermis            Int
    id_antenne               Int?
    id_detenteur             Int?
    id_statut                Int?
    code_permis              String?   
    date_adjudication        DateTime?
    date_octroi              DateTime?
    date_signature           DateTime?
    date_expiration          DateTime?
    duree_validite           Int? // in years
    lieu_ditFR               String?
    lieu_ditAR               String?
    mode_attribution         String?
    superficie               Float?
    utilisation              String?
    montant_offre            String?
    statut_activites         String?
    nombre_renouvellements   Int?
    hypothec                 String?
    date_conversion_permis   DateTime?
    date_option_permis       DateTime?
    commentaires             String?
    validation               Boolean?
      is_signed                Boolean?  @default(false)
        date_remise_titre        DateTime?
        nom_remise_titre         String?
        qr_code                  String?
        date_heure_systeme       DateTime?
        qr_inserer_par           String?
        code_wilaya              String?
        // Relations
      typePermis         TypePermis           @relation(fields: [id_typePermis], references: [id])
      antenne            Antenne?             @relation(fields: [id_antenne], references: [id_antenne])
      detenteur          DetenteurMoralePortail?     @relation(fields: [id_detenteur], references: [id_detenteur])
    statut             StatutPermis?        @relation(fields: [id_statut], references: [id])
    permisProcedure    permisProcedure[]
    RapportActivite    RapportActivite[]
    CahierCharge       CahierChargePortail[]
    ObligationFiscale  ObligationFiscale[]
    demFusion          demFusion?
    fusionPermisSource fusionPermisSource[]
    codeAssimilation codeAssimilation[]
    PermisTemplate     PermisTemplate[]
    @@index([date_octroi(sort: Desc)], map: "idx_permis_date_octroi")
    @@index([id_statut, date_octroi(sort: Desc)], map: "idx_permis_id_statut_date_octroi")
    @@index([id_statut, date_expiration(sort: Desc)], map: "idx_permis_id_statut_date_expiration")
    @@index([code_permis], map: "idx_permis_code_permis")
    @@map("PermisPortail") 
}

model fusionPermisSource {
  id_permis Int
  id_fusion Int
  demFusion demFusion     @relation(fields: [id_fusion], references: [id_fusion])
  permis    PermisPortail @relation(fields: [id_permis], references: [id])

  @@id([id_permis, id_fusion])
}

model codeAssimilation {
  id_code       Int              @id @default(autoincrement())
  id_ancienType Int
  id_permis     Int
  ancien_code   String
  ancienType    AncienTypePermis @relation(fields: [id_ancienType], references: [id_ancienType])
  permis        PermisPortail    @relation(fields: [id_permis], references: [id])
}

model AncienTypePermis {
  id_ancienType    Int                @id @default(autoincrement())
  lib_type         String
  code_type        String
  codeAssimilation codeAssimilation[]
}

model CahierChargePortail {
  id                        Int             @id @default(autoincrement())
  permisId                  Int?
  demandeId                 Int?
  num_cdc                   String
  date_etablissement        DateTime
  dateExercice              DateTime
  lieu_signature            String
  signataire_administration String
  fuseau                    String?
  typeCoordonnees           String?
  version                   String?
  natureJuridique           String?
  vocationTerrain           String?
  nomGerant                 String?
  personneChargeTrxx        String?
  qualification             String?
  reservesGeologiques       Float?
  reservesExploitables      Float?
  volumeExtraction          Float?
  dureeExploitation         Int?
  methodeExploitation       String?
  dureeTravaux              Int?
  dateDebutTravaux          DateTime?
  dateDebutProduction       DateTime?
  investissementDA          Float?
  investissementUSD         Float?
  capaciteInstallee         Float?
  commentaires              String?
  createdAt                 DateTime        @default(now())
  updatedAt                 DateTime        @updatedAt
  demande                   demandePortail? @relation(fields: [demandeId], references: [id_demande])
  permis                    PermisPortail?  @relation(fields: [permisId], references: [id])

  @@map("cahiercharge")
}

model StatutPermis {
  id          Int             @id @default(autoincrement())
  lib_statut  String          @unique
  description String
  Permis      PermisPortail[]
}

model documentPortail {
  id_doc                  Int                             @id @default(autoincrement())
  nom_doc                 String
  description             String
  format                  String
  taille_doc              String
  statutDetenteur         StatutDetenteur?
  dossierDocuments        DossierDocumentPortail[]
  dossierFournisDocuments DossierFournisDocumentPortail[]
}

model DossierDocumentPortail {
  id_dossier     Int
  id_doc         Int
  is_obligatoire Boolean              @default(true)
  missing_action MissingAction        @default(BLOCK_NEXT)
  reject_message String?              @db.VarChar(500)
  document       documentPortail      @relation(fields: [id_doc], references: [id_doc], onDelete: Cascade)
  dossier        DossierAdministratif @relation(fields: [id_dossier], references: [id_dossier], onDelete: Cascade)

  @@id([id_dossier, id_doc])
  @@map("dossier_documents_portail")
}

model DossierAdministratif {
  id_dossier       Int                      @id @default(autoincrement())
  id_typeproc      Int
  id_typePermis    Int
  nombre_doc       Int
  remarques        String?
  typePermis       TypePermis               @relation(fields: [id_typePermis], references: [id])
  typeProcedure    TypeProcedure            @relation(fields: [id_typeproc], references: [id])
  dossierDocuments DossierDocumentPortail[]

  @@unique([id_typePermis, id_typeproc])
}

model DossierFournisPortail {
  id_dossierFournis       Int                             @id @default(autoincrement())
  id_demande              Int
  date_depot              DateTime                        @default(now())
  recevabilite_doss       Boolean?
  statut_dossier          String
  remarques               String?
  numero_accuse           String?
  date_accuse             DateTime?
  numero_recepisse        String?
  date_recepisse          DateTime?
  mise_en_demeure_envoyee Boolean                         @default(false)
  date_mise_en_demeure    DateTime?
  pieces_manquantes       Json?
  verification_phase      String?
  date_preannotation      DateTime?
  demande                 demandePortail                  @relation(fields: [id_demande], references: [id_demande])
  documents               DossierFournisDocumentPortail[]

  @@map("dossier_fournis")
}

model DossierFournisDocumentPortail {
  id_dossierFournis Int
  id_doc            Int
  status            String
  file_url          String?
  created_at        DateTime              @default(now())
  updated_at        DateTime              @updatedAt
  document          documentPortail       @relation(fields: [id_doc], references: [id_doc])
  dossierFournis    DossierFournisPortail @relation(fields: [id_dossierFournis], references: [id_dossierFournis])

  @@id([id_dossierFournis, id_doc])
  @@map("dossier_fournis_document")
}

model TypeProcedure {
  id                     Int                     @id @default(autoincrement())
  libelle                String?
  description            String?
  DossierAdministratif   DossierAdministratif[]
  Bareme                 BaremProduitetDroit[]
  combinaisionPermisProc combinaisonPermisProc[]
  Demande                demandePortail[]

  @@map("typeprocedure")
}

/// model Phase {
/// id_phase              Int                     @id @default(autoincrement())
/// libelle               String
/// ordre                 Int
/// description           String?
/// etapes                EtapeProc[]
/// procedurePhases       ProcedurePhase[]
/// procedurePhaseEtapes  procedurePhaseEtapes[]
/// relationPhaseTypeProc relationPhaseTypeProc[]
///
/// @@map("phase")
/// }
///
/// model EtapeProc {
/// id_etape             Int                    @id @default(autoincrement())
/// lib_etape            String
/// duree_etape          Int?
/// ordre_etape          Int
/// id_phase             Int?
/// page_route           String?
/// phase                Phase?                 @relation(fields: [id_phase], references: [id_phase])
/// procedureEtapes      ProcedureEtape[]
/// procedurePhaseEtapes procedurePhaseEtapes[]
///
/// @@map("etape_proc")
/// }
///
/// model ProcedurePhase {
/// id_proc   Int
/// id_phase  Int
/// ordre     Int
/// statut    StatutProcedure?
/// phase     Phase            @relation(fields: [id_phase], references: [id_phase])
/// procedure ProcedurePortail @relation(fields: [id_proc], references: [id_procedure])
///
/// @@id([id_proc, id_phase])
/// @@map("procedure_phase")
/// }
///
/// model ProcedureEtape {
/// id_proc    Int
/// id_etape   Int
/// statut     StatutProcedure
/// date_debut DateTime
/// date_fin   DateTime?
/// link       String?
/// etape      EtapeProc        @relation(fields: [id_etape], references: [id_etape])
/// procedure  ProcedurePortail @relation(fields: [id_proc], references: [id_procedure])
///
/// @@id([id_proc, id_etape])
/// @@map("procedure_etape")
/// }
///
/// model procedurePhaseEtapes {
/// id_procPhaseEtape Int              @id @default(autoincrement())
/// id_proc           Int
/// id_phase          Int
/// id_etape          Int?
/// statut_etape      String?
/// date_debut        DateTime?
/// date_fin          DateTime?
/// link              String?
/// etape             EtapeProc?       @relation(fields: [id_etape], references: [id_etape])
/// phase             Phase            @relation(fields: [id_phase], references: [id_phase])
/// procedure         ProcedurePortail @relation(fields: [id_proc], references: [id_procedure])
///
/// @@map("procedure_phase_etapes")
/// }
///
/// model combinaisonPermisProc {
/// id_combinaison        Int                     @id @default(autoincrement())
/// id_typePermis         Int
/// id_typeProc           Int
/// duree_regl_proc       Int?
/// typePermis            TypePermis              @relation(fields: [id_typePermis], references: [id])
/// typeProc              TypeProcedure           @relation(fields: [id_typeProc], references: [id])
/// relationPhaseTypeProc relationPhaseTypeProc[]
///
/// @@unique([id_typePermis, id_typeProc])
/// @@map("combinaison_typepermis")
/// }
///
/// model relationPhaseTypeProc {
/// id_relation    Int                   @id @default(autoincrement())
/// id_phase       Int
/// id_combinaison Int
/// ordre          Int?
/// dureeEstimee   Int?
/// combinaison    combinaisonPermisProc @relation(fields: [id_combinaison], references: [id_combinaison])
/// phase          Phase                 @relation(fields: [id_phase], references: [id_phase])
///
/// @@map("relation_phase_typeprocedure")
/// }
/// ////////
model EtapeProc {
  id_etape        Int              @id @default(autoincrement())
  lib_etape       String
  ManyEtapes      ManyEtape[]
  procedureEtapes ProcedureEtape[]

  @@map("etape_proc")
}

model Phase {
  id_phase        Int              @id @default(autoincrement())
  libelle         String
  ordre           Int
  description     String?
  ManyEtapes      ManyEtape[]
  procedurePhases ProcedurePhase[]

  @@map("phase")
}

model ManyEtape {
  id_manyEtape          Int                     @id @default(autoincrement())
  id_phase              Int
  id_etape              Int
  duree_etape           Int?
  ordre_etape           Int
  page_route            String?
  etape                 EtapeProc               @relation(fields: [id_etape], references: [id_etape])
  phase                 Phase                   @relation(fields: [id_phase], references: [id_phase])
  procedurePhaseEtapes  procedurePhaseEtapes[]
  relationPhaseTypeProc relationPhaseTypeProc[]

  @@unique([id_phase, id_etape])
  @@map("many_etape")
}

model relationPhaseTypeProc {
  id_relation    Int                   @id @default(autoincrement())
  id_combinaison Int
  ordre          Int?
  dureeEstimee   Int?
  id_manyEtape   Int?
  combinaison    combinaisonPermisProc @relation(fields: [id_combinaison], references: [id_combinaison])
  manyEtape      ManyEtape?            @relation(fields: [id_manyEtape], references: [id_manyEtape])

  @@map("relation_phase_typeprocedure")
}

model ProcedurePhase {
  id_proc   Int
  id_phase  Int
  ordre     Int
  statut    StatutProcedure?
  phase     Phase            @relation(fields: [id_phase], references: [id_phase])
  procedure ProcedurePortail @relation(fields: [id_proc], references: [id_proc])

  @@id([id_proc, id_phase])
  @@map("procedure_phase")
}

model ProcedureEtape {
  id_proc    Int
  id_etape   Int
  statut     StatutProcedure
  date_debut DateTime
  date_fin   DateTime?
  link       String?
  etape      EtapeProc        @relation(fields: [id_etape], references: [id_etape])
  procedure  ProcedurePortail @relation(fields: [id_proc], references: [id_proc])

  @@id([id_proc, id_etape])
  @@map("procedure_etape")
}

model procedurePhaseEtapes {
  id_procPhaseEtape Int              @id @default(autoincrement())
  id_proc           Int
  statut_etape      String?
  date_debut        DateTime?
  date_fin          DateTime?
  link              String?
  id_manyEtape      Int?
  manyEtape         ManyEtape?       @relation(fields: [id_manyEtape], references: [id_manyEtape])
  procedure         ProcedurePortail @relation(fields: [id_proc], references: [id_proc])

  @@map("procedure_phase_etapes")
}

model permisProcedure {
  id_procedurePermis Int              @id @default(autoincrement())
  id_permis          Int
  id_proc            Int
  permis             PermisPortail    @relation(fields: [id_permis], references: [id])
  procedure          ProcedurePortail @relation(fields: [id_proc], references: [id_proc])
  date_octroi_proc   DateTime?

  @@unique([id_permis, id_proc])
  @@map("permis_procedure")
}

model combinaisonPermisProc {
  id_combinaison        Int                     @id @default(autoincrement())
  id_typePermis         Int
  id_typeProc           Int
  duree_regl_proc       Int?
  typePermis            TypePermis              @relation(fields: [id_typePermis], references: [id])
  typeProc              TypeProcedure           @relation(fields: [id_typeProc], references: [id])
  relationPhaseTypeProc relationPhaseTypeProc[]

  @@unique([id_typePermis, id_typeProc])
  @@map("combinaison_typepermis")
}

model Substance {
  id_sub           Int                        @id @default(autoincrement())
  nom_subFR        String?
  nom_subAR        String?
  categorie_sub    String?
  id_redevance     Int?
  associeesDemande SubstanceAssocieeDemande[]
  redevance        RedevanceBareme?           @relation(fields: [id_redevance], references: [id_redevance])

  @@map("substances")
}

model RedevanceBareme {
  id_redevance     Int         @id @default(autoincrement())
  taux_redevance   Float
  valeur_marchande Float
  unite            String
  devise           String
  description      String
  substances       Substance[]

  @@map("redevance_bareme")
}

model SubstanceAssocieeDemande {
  id_assoc     Int              @id @default(autoincrement())
  id_proc      Int
  id_substance Int?
  priorite     Enumpriorite?
  date_ajout   DateTime?        @default(now())
  procedure    ProcedurePortail @relation(fields: [id_proc], references: [id_proc])
  substance    Substance?       @relation(fields: [id_substance], references: [id_sub])

  @@unique([id_proc, id_substance])
  @@map("substance_associee_demande")
}

model ProcedurePortail {
  id_seance                Int?
  num_proc                 String?                       @unique
  date_debut_proc          DateTime?
  date_fin_proc            DateTime?
  statut_proc              StatutProcedure
  resultat                 String?
  observations             String?
  cause_blocage            String?
  date_blocage             DateTime?
  typeProcedureId          Int?
  id_proc                  Int                           @id @default(autoincrement())
  coordonnees              ProcedureCoord[]
  demandes                 demandePortail[]
  sourceDemandes           demandePortail[]              @relation("DemandeSource")
  inscriptionProvisoire    InscriptionProvisoirePortail?
  InteractionWali          InteractionWaliPortail[]
  permisProcedure          permisProcedure[]
  seance                   SeanceCDPrevue?               @relation("SeanceProcedures", fields: [id_seance], references: [id_seance])
  ProcedureEtape           ProcedureEtape[]
  ProcedurePhase           ProcedurePhase[]
  procedurePhaseEtapes     procedurePhaseEtapes[]
  SubstanceAssocieeDemande SubstanceAssocieeDemande[]

  @@map("procedure")
}

model ProcedureCoord {
  id_procedureCoord Int               @id @default(autoincrement())
  id_proc           Int
  id_coordonnees    Int
  statut_coord      StatutCoord
  coordonnee        CoordonneePortail @relation(fields: [id_coordonnees], references: [id_coordonnees])
  procedure         ProcedurePortail  @relation(fields: [id_proc], references: [id_proc])

  @@unique([id_proc, id_coordonnees])
}

model CoordonneePortail {
  id_coordonnees    Int              @id @default(autoincrement())
  id_zone_interdite Int?
  point             String?          @db.VarChar(100)
  x                 Float
  y                 Float
  z                 Float            @default(0)
  system            String?          @default("WGS84") @db.VarChar(20)
  zone              Int?
  hemisphere        String?          @db.VarChar(1)
  procedureLinks    ProcedureCoord[]

  @@map("coordonnee_portail")
}

model InscriptionProvisoirePortail {
  id                  Int              @id @default(autoincrement())
  id_proc             Int              @unique
  id_demande          Int              @unique
  points              Json
  system              String?
  zone                Int?
  hemisphere          String?
  superficie_declaree Float?
  createdAt           DateTime         @default(now())
  updatedAt           DateTime         @updatedAt
  demande             demandePortail   @relation(fields: [id_demande], references: [id_demande])
  procedure           ProcedurePortail @relation(fields: [id_proc], references: [id_proc])

  @@map("inscription_provisoire")
}

model InteractionWaliPortail {
  id                        Int                      @id @default(autoincrement())
  idInterne                 Int?                     @unique
  id_procedure              Int                      @map("id_procedure")
  id_wilaya                 Int
  type_interaction          EnumTypeInteraction?
  avis_wali                 EnumAvisWali?            @default(EN_ATTENTE)
  date_envoi                DateTime?
  date_reponse              DateTime?
  delai_depasse             Boolean?                 @default(false)
  nom_responsable_reception String?                  @db.VarChar(255)
  commentaires              String?
  contenu                   String?
  is_relance                Boolean                  @default(false)
  relance_parent_id         Int?
  creeLe                    DateTime                 @default(now())
  modifieLe                 DateTime                 @updatedAt
  procedure                 ProcedurePortail         @relation(fields: [id_procedure], references: [id_proc], onDelete: Cascade)
  wilaya                    Wilaya                   @relation(fields: [id_wilaya], references: [id_wilaya])
  relance_parent            InteractionWaliPortail?  @relation("RelanceInteraction", fields: [relance_parent_id], references: [id])
  relances                  InteractionWaliPortail[] @relation("RelanceInteraction")

  @@index([id_procedure])
  @@index([id_wilaya])
  @@index([avis_wali])
  @@index([date_envoi])
  @@index([is_relance])
  @@map("interactions_wali_portail")
}

model CorrespondanceSynchro {
  id            Int      @id @default(autoincrement())
  entitePortail String   @db.VarChar(100)
  idPortail     Int
  entiteInterne String   @db.VarChar(100)
  idInterne     Int
  statut        String   @default("SYNCED") @db.VarChar(20)
  error         Json?
  synchroLe     DateTime @default(now())

  @@unique([entitePortail, idPortail])
  @@unique([entiteInterne, idInterne])
  @@map("correspondance_synchro")
}

model TypePaiement {
  id             Int                 @id @default(autoincrement())
  libelle        String              @unique
  frequence      String
  details_calcul String?
  obligations    ObligationFiscale[]

  @@map("typepaiement")
}

model ObligationFiscale {
  id              Int                @id @default(autoincrement())
  id_typePaiement Int
  id_permis       Int
  annee_fiscale   Int
  montant_attendu Float
  date_echeance   DateTime
  statut          EnumStatutPaiement
  details_calcul  String?
  tsPaiements     TsPaiement[]
  permis          PermisPortail      @relation(fields: [id_permis], references: [id])
  typePaiement    TypePaiement       @relation(fields: [id_typePaiement], references: [id])
  paiements       Paiement[]

  @@map("obligationfiscale")
}

model Paiement {
  id               Int                @id @default(autoincrement())
  id_obligation    Int
  montant_paye     Float
  devise           String             @default("DZD")
  date_paiement    DateTime
  mode_paiement    String
  num_quittance    String?
  etat_paiement    String
  justificatif_url String?
  num_perc         String?
  date_remisOp     DateTime?
  created_at       DateTime           @default(now())
  updated_at       DateTime           @updatedAt
  idUtilisateur    Int
  id_facture       Int
  utilisateur      UtilisateurPortail @relation(fields: [idUtilisateur], references: [id], onDelete: Cascade)
  facture          Facture            @relation(fields: [id_facture], references: [id_facture])
  obligation       ObligationFiscale  @relation(fields: [id_obligation], references: [id])

  @@map("paiement")
}

/// ajout de cette table pour la gestion des factures
model Facture {
  id_facture     Int            @id @default(autoincrement())
  numero_facture String         @unique
  montant_total  Float
  date_emission  DateTime       @default(now())
  id_demande     Int            @unique
  type_facture   FactureType    @default(INVESTISSEUR)
  devise         DeviseFacture  @default(DZD)
  statut         StatutFacture  @default(BROUILLON)
  demande        demandePortail @relation(fields: [id_demande], references: [id_demande], onDelete: Cascade)
  paiements      Paiement[]
}

model TsPaiement {
  id_tsPaiement Int               @id @default(autoincrement())
  id_obligation Int
  datePerDebut  DateTime
  datePerFin    DateTime
  surfaceMin    Float
  surfaceMax    Float
  obligation    ObligationFiscale @relation(fields: [id_obligation], references: [id])
}

model RapportActivite {
  id_rapport               Int           @id @default(autoincrement())
  id_permis                Int
  date_remise_reelle       DateTime
  etat_activite            String
  leve_topo_3112           String?
  leve_topo_3006           String?
  plan_exploitation        String?
  date_debut_travaux       DateTime?
  vente_exportation        String?
  importation              String?
  valeur_equipement_acquis Float?
  pros_expl_entamee        String?
  avancee_travaux          String?
  travaux_realises         String?
  nbr_ouvrages             Int?
  volume                   Float?
  resume_activites         String?
  investissements_realises Float?
  qte_explosifs            Float?
  qte_explosifs_DIM        Float?
  detonateurs              Int?
  dmr                      Int?
  cordeau_detonant         Int?
  meche_lente              Int?
  relais                   Int?
  DEI                      Int?
  effectif_cadre           Int?
  effectif_maitrise        Int?
  effectif_execution       Int?
  production_toutvenant    Float?
  production_marchande     Float?
  production_vendue        Float?
  production_stocke        Float?
  stock_T_V                Float?
  stock_produit_marchand   Float?
  production_sable         Float?
  poussieres               Float?
  rejets_laverie           Float?
  fumee_gaz                Float?
  autres_effluents         Float?
  nbr_accidents            Int?
  accidents_mortels        Int?
  accidents_non_mortels    Int?
  nbrs_jours_perdues       Int?
  taux_frequence           Float?
  taux_gravite             Float?
  nbrs_incidents           Int?
  nbrs_malades_pro         Int?
  remise_etat_realisee     String?
  cout_remise_etat         Float?
  commentaires_generaux    String?
  rapport_url              String?
  permis                   PermisPortail @relation(fields: [id_permis], references: [id])

  @@map("rapport_activite")
}

model SeanceCDPrevue {
  id_seance     Int                @id @default(autoincrement())
  num_seance    String
  date_seance   DateTime
  exercice      Int
  remarques     String?
  statut        EnumStatutSeance
  comites       ComiteDirection[]  @relation("SeanceComites")
  seancesMembre MembreSeance[]
  procedures    ProcedurePortail[] @relation("SeanceProcedures")
  membres       MembresComite[]    @relation("SeanceMembres")
}

model ComiteDirection {
  id_comite       Int            @id @default(autoincrement())
  id_seance       Int
  date_comite     DateTime
  resume_reunion  String
  fiche_technique String?
  carte_projettee String?
  rapport_police  String?
  seance          SeanceCDPrevue @relation("SeanceComites", fields: [id_seance], references: [id_seance])
  decisionCDs     DecisionCD[]
}

model DecisionCD {
  id_decision     Int                @id @default(autoincrement())
  id_comite       Int
  numero_decision String
  duree_decision  Int?
  commentaires    String?
  decision_cd     EnumDecisionComite
  comite          ComiteDirection    @relation(fields: [id_comite], references: [id_comite])
}

model MembresComite {
  id_membre       Int              @id @default(autoincrement())
  nom_membre      String
  prenom_membre   String
  fonction_membre String
  email_membre    String
  membreSeance    MembreSeance[]
  seances         SeanceCDPrevue[] @relation("SeanceMembres")
}

model MembreSeance {
  id_seance Int
  id_membre Int
  membre    MembresComite  @relation(fields: [id_membre], references: [id_membre])
  seance    SeanceCDPrevue @relation(fields: [id_seance], references: [id_seance])

  @@id([id_seance, id_membre])
}

model DroitPreemption {
  id_droit              Int                   @id @default(autoincrement())
  demandeId             Int                   @unique
  statut                StatutDroitPreemption @default(EN_ATTENTE)
  pieceJustificativeUrl String?
  nomFichierOriginal    String?
  dateDepotPiece        DateTime?
  dateDecisionEtat      DateTime?
  commentaires          String?
  demande               demandePortail        @relation(fields: [demandeId], references: [id_demande], onDelete: Cascade)

  @@map("droit_preemption")
}

enum EnumStatutSeance {
  programmee
  terminee
}

enum EnumDecisionComite {
  favorable
  defavorable
  autre
}

enum EnumTypeDetenteur {
  ANCIEN
  NOUVEAU
}

enum RoleUtilisateur {
  INVESTISSEUR
  OPERATEUR
  ADMIN
}

enum TypeProcedureEnum {
  DEMANDE
  RENOUVELLEMENT
  TRANSFERT
  CESSION
  AMODIATION
  RENONCIATION
  AUTRE
}

enum StatutDemande {
  ACCEPTEE
  REJETEE
  EN_ATTENTE
  EN_COURS
}

enum StatutPaiement {
  EN_ATTENTE
  PAYE
  ECHEC
}

enum TypeNotification {
  INFO
  AVIS
  TAXE
  ALERTE
  REPONSE
}

enum EnumTypeFonction {
  Representant
  Actionnaire
  Representant_Actionnaire
}

enum PouvoirPersonnePhysique {
  MANDAT
  PROCURATION
}

enum StatutCoord {
  DEMANDE_INITIALE
  NOUVEAU
  ANCIENNE
}

enum MissingAction {
  BLOCK_NEXT
  REJECT
  WARNING
}

enum EnumTypeInteraction {
  envoi
  relance
  reponse
}

enum EnumAvisWali {
  favorable
  defavorable
  EN_ATTENTE
}

enum StatutProcedure {
  EN_COURS
  TERMINEE
  EN_ATTENTE
}

enum StatutDetenteur {
  PERSONNE_MORALE_ALGERIENNE
  PERSONNE_MORALE_ETRANGERE
  PERSONNE_PHYSIQUE_ALGERIENNE
}

enum StatutDroitPreemption {
  EXERCE
  RENONCE
  EN_ATTENTE
}

enum Enumpriorite {
  principale
  secondaire
}

enum EnumStatutPaiement {
  A_payer
  Paye
  En_retard
  Annule
  Partiellement_paye
}

enum StatutFacture {
  BROUILLON
  EMISE
  PAYEE
  ANNULEE
}

enum DeviseFacture {
  DZD
  EUR
  USD
}

enum FactureType {
  INVESTISSEUR
  OPERATEUR
}
